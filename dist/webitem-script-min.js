// webitem.js Library to simplify creating HTML5 Custom Elements
// https://github.com/ahabra/webitem
// Copyright 2021 (C) Abdul Habra. Version 0.3.6.
// Apache License Version 2.0


var webitem=(()=>{var z=Object.defineProperty;var G=(e,n)=>{for(var t in n)z(e,t,{get:n[t],enumerable:!0})};var $e={};G($e,{defineElement:()=>k});var J=Object.defineProperty,l=(e,n)=>{for(var t in n)J(e,t,{get:n[t],enumerable:!0})},f={};l(f,{add:()=>Y,all:()=>S,classPresentIf:()=>ne,createElement:()=>X,createElements:()=>A,first:()=>Q,getAttributes:()=>U,id:()=>K,removeElements:()=>ee,setContent:()=>Z,tag:()=>L});var g={};l(g,{equals:()=>N,forEachEntry:()=>y,has:()=>ie,isDate:()=>p,isFunction:()=>C,isInteger:()=>re,isNil:()=>te,isNumber:()=>O,isRegExp:()=>x,isString:()=>d});function te(e){return e==null}function d(e){return a(e,"String")}function C(e){return a(e,"Function")}function p(e){return a(e,"Date")}function O(e){return a(e,"Number")?Number.isNaN(e)?!1:Number.isFinite(e):!d(e)||(e=e.trim(),e==="")?!1:!isNaN(e)}function re(e){return O(e)?Number.isInteger(Number.parseFloat(e)):!1}function x(e){return a(e,"RegExp")}function a(e,n){return Object.prototype.toString.call(e)===`[object ${n}]`}function y(e,n){if(!(!e||!n)){if(Array.isArray(e)){e.forEach((t,r)=>{n(r,t)});return}Object.entries(e).forEach(t=>n(t[0],t[1]))}}function ie(e,n){return!e||!n?!1:Object.prototype.hasOwnProperty.call(e,n)}function N(e,n){return e===n?!0:e===void 0||n===void 0?!1:ue(e,n)}function ue(e,n){return T(e)||T(n)?e===n:oe(e,n)}var se=new Set(["boolean","number","bigint","string","symbol"]);function T(e){return se.has(typeof e)}function oe(e,n){return fe(e,n)?ae(e,n)?!0:ce(e,n):!1}function fe(e,n){return $(e)===$(n)}function $(e){return Object.prototype.toString.call(e)}function ae(e,n){return p(e)&&p(n)?e.getTime()===n.getTime():!1}function ce(e,n){let t=Object.keys(e);return t.length!==Object.keys(n).length?!1:t.every(r=>N(e[r],n[r]))}function K(e,n=document){return E(n)&&(n=n.shadowRoot),n.getElementById(e)}function S(e,n=document){return E(n)&&(n=n.shadowRoot),Array.from(n.querySelectorAll(e))}function Q(e,n=document){if(E(n)&&(n=n.shadowRoot),!e.includes("/"))return n.querySelector(e);let t=e.split("/").map(r=>r.trim()).filter(r=>r.length>0);for(let r of t)if(n=le(r,n),n===null)break;return n}function le(e,n){return e==="shadowRoot"||e==="shadow-root"?n.shadowRoot:n.querySelector(e)}function E(e){return e&&e.shadowRoot&&e.tagName.includes("-")}function U(e){let n={},t=e.attributes;if(!t||t.length===0)return n;for(let r=0;r<t.length;r++){let i=t[r];n[i.name]=i.value}return n}function A(e=""){if(e=e.trim(),!e)return[];let n=document.createElement("template");return n.innerHTML=e,Array.from(n.content.childNodes)}function X(e,n={},t=""){let r=L(e,n,t),i=A(r);return i.length===0?null:i[0]}function L(e,n={},t=""){if(!e)return"";let r=de(n);return`<${e}${r}>${t}</${e}>`}function de(e){let n=[];return y(e,(r,i)=>{n.push(`${r}="${i}"`)}),(n.length>0?" ":"")+n.join(" ")}var me=new Set(["beforebegin","afterbegin","beforeend","afterend"]);function Y(e,n,t="beforeend"){return t=t.toLowerCase(),me.has(t)?(d(n)?e.insertAdjacentHTML(t,n):he(e,n,t),!0):!1}function he(e,n,t){Array.isArray(n)?n.forEach(r=>e.insertAdjacentElement(t,r)):e.insertAdjacentElement(t,n)}function Z(e,...n){e.innerHTML="",e.append(...n)}function ee(e,n=document){S(e,n).forEach(r=>{r.parentNode.removeChild(r)})}function ne(e,n,t){if(!e)return;let r=t?"add":"remove";e.classList[r](n)}var c={};l(c,{endsWith:()=>q,indexOf:()=>b,indexOfFirstMatch:()=>ge,indexOfLastMatch:()=>pe,isEmpty:()=>M,removePrefix:()=>P,removeSuffix:()=>j,removeSurrounding:()=>ye,replaceAll:()=>W,replaceTemplate:()=>ve,startsWith:()=>R,substringAfter:()=>Ee,substringBefore:()=>be,trim:()=>v});function b(e,n,t=0,r=!1){return e?r?e.toLowerCase().indexOf(n.toLowerCase(),t):e.indexOf(n,t):-1}function ge(e,n){return!n||!e?-1:e.split("").findIndex(n)}function pe(e,n){if(!n||!e)return-1;let t=e.split("");for(let r=t.length;r>=0;--r)if(n(t[r],r))return r;return-1}function R(e="",n=void 0,t=!1){if(t){let r=e.substring(0,n.length).toLowerCase();return n.toLowerCase()===r}return e.startsWith(n)}function q(e,n,t=!1){return t?e.toLowerCase().endsWith(n.toLowerCase()):e.endsWith(n)}function P(e,n,t=!1){return R(e,n,t)&&(e=e.substring(n.length)),e}function j(e,n,t=!1){return q(e,n,t)&&(e=e.substring(0,e.length-n.length)),e}function ye(e,n,t,r=!1){return j(P(e,n,r),t,r)}function Ee(e,n,t=!1){if(!n)return e;let r=b(e,n,0,t);return r<0?"":e.substring(r+n.length)}function be(e,n,t=!1){if(!n)return"";let r=b(e,n,0,t);return r<0?e:e.substring(0,r)}function v(e){return M(e)?"":(d(e)||(e=String(e)),e.trim(e))}function M(e){return e==null||e===""}function W(e,n,t){if(C(String.prototype.replaceAll))return e.replaceAll(n,t);if(x(n))return e.replace(n,t);let r=new RegExp(n,"g");return e.replace(r,t)}function ve(e="",n={},t="${",r="}"){return y(n,(i,u)=>{u!==void 0&&(i=t+i+r,e=W(e,i,u))}),e}var we={};l(we,{compareLines:()=>Se});function Se(e,n,{trim:t=!0,skipEmpty:r=!0,caseSensitive:i=!0}={trim:!0,skipEmpty:!0,caseSensitive:!0}){if(e=D(e,{trim:t,skipEmpty:r}),n=D(n,{trim:t,skipEmpty:r}),e.length!==n.length)return`t1 has ${e.length} lines(s) while t2 has ${n.length} line(s).`;for(let u=0;u<e.length;u++){let o=Ae(e[u],n[u],u,i);if(o.length>0)return o}return""}function Ae(e,n,t,r){let i=r?e:e.toLowerCase(),u=r?n:n.toLowerCase();return i!==u?`Line #${t+1} mismatch.
${e}
${n}`:""}function D(e,{trim:n,skipEmpty:t}){return n&&(e=v(e)),e=e.split(`
`),n&&(e=e.map(r=>v(r))),t&&(e=e.filter(r=>!!r)),e}function w({obj:e,prop:n,sel:t,attr:r,root:i,onChange:u}){Ce(n),e=e||{};let o=e.hasOwnProperty(n)?e[n]:void 0;i=i||document;let s={};return Object.defineProperty(e,n,{get:()=>F({prop:n,sel:t,attr:r,root:i,objNotBound:s}),set:B=>Le({prop:n,value:B,root:i,sel:t,attr:r,objNotBound:s,onChange:u}),configurable:!0,enumerable:!0}),o!==void 0&&(console.info(`Property '${n}' already exists in object. Will override previous definition but retain old value of ${o}.`),e[n]=o),e}var m=e=>e.type==="checkbox",h=e=>e.type==="radio",_=e=>e.tagName.toLowerCase()==="select",H=e=>"value"in e,V=e=>new Set(Array.isArray(e)?e:[e]);function Le({prop:e,value:n,root:t,sel:r,attr:i,objNotBound:u,onChange:o}){if(Oe({prop:e,value:n,root:t,sel:r,attr:i,objNotBound:u,onChange:o}),r){xe(t,r,n,i);return}u[e]=n}function Oe({prop:e,value:n,root:t,sel:r,attr:i,objNotBound:u,onChange:o}){if(!o)return;let s=F({prop:e,root:t,sel:r,attr:i,objNotBound:u});s!==n&&o(s,n)}function F({prop:e,root:n,sel:t,attr:r,objNotBound:i}){return t?Ne(n,t,r):i[e]}function Ne(e,n,t){let r=I(e,n);if(r.length===0)return null;let i=r[0];if(t)return i.getAttribute(t);if(!H(i))return i.innerHTML;if(m(i))return r.filter(u=>m(u)&&u.checked).map(u=>u.value==="on"?u.name:u.value);if(_(i))return[...i.querySelectorAll("option")].filter(o=>o.selected).map(o=>o.value);if(!(h(i)&&(i=r.filter(h).find(u=>u.checked),!i)))return i.value}function xe(e,n,t,r){let i=I(e,n);if(i.length===0)return;let u=i[0];if(m(u)){let o=V(t);i.filter(m).forEach(s=>s.checked=o.has(s.value)||o.has(s.name));return}if(_(u)){let o=V(t);u.querySelectorAll("option").forEach(s=>s.selected=o.has(s.value));return}if(h(u)){i.filter(h).forEach(o=>o.checked=o.value===t);return}i.forEach(o=>Te(o,t,r))}function Te(e,n,t){t?e.setAttribute(t,n):H(e)?e.value=n:e.innerHTML=n}function I(e,n){let t=e.querySelectorAll(n);return t.length===0&&console.warn(`No elements found matching selector ${n}`),[...t]}function Ce(e){if(typeof e!="string"||e.length===0)throw"'prop' argument must be a String defining the name a property."}function k({nameWithDash:e,html:n,css:t,display:r,propertyList:i,actionList:u,eventHandlerList:o}){if(customElements.get(e))return!1;let s=class extends HTMLElement{constructor(){super();je(this,n,t,r),this.properties=Re(this,i),this.actions=qe(this,u),Pe(this,o)}};return customElements.define(e,s),!0}function Re(e,n){let t={};return We(n)&&n.forEach(r=>Me(t,r,e)),t}function Me(e,n,t){let r=De(n,t);w({obj:e,prop:n.name,sel:n.sel,attr:n.attr,root:t.shadowRoot,onChange:r}),n.value!==void 0&&(e[n.name]=n.value)}function De(e,n){if(!!e.onChange)return(t,r)=>e.onChange(n,t,r)}function We(e){if(!e)return!1;if(!Array.isArray(e))throw"propertyList must be an array of {name, value, [sel], [attr]} objects";return!0}function qe(e,n){let t={};return n&&n.forEach(r=>{r.name&&r.action&&(t[r.name]=r.action.bind(e))}),t}function Pe(e,n){if(!!n){if(!Array.isArray(n))throw"eventHandlerList must be an array of {sel, eventName, listener} objects";n.forEach(t=>{f.all(t.sel,e.shadowRoot).forEach(i=>{i.addEventListener(t.eventName,u=>{t.listener(u,e)})})})}}function je(e,n,t,r){n=Fe(e,n);let i=e.attachShadow({mode:"open"}),u=f.createElements(_e(t,r)+n);i.append(...u)}function Fe(e,n){return g.isFunction(n)?n(e):n}function _e(e,n){return Ve(n)+He(e)}function He(e){return e=c.trim(e),e.length===0?"":(c.startsWith(e,"<style>",!1)||(e=f.tag("style",{},e)),e)}function Ve(e){return e=c.trim(e),e.length===0?"":`
  <style>
    :host { display: ${e};}
    :host([hidden]) {display: none;}
  </style>
  `}return $e;})();
